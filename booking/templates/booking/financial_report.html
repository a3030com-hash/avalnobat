{% extends 'booking/base.html' %}
{% load booking_filters %}

{% block title %}{{ page_title }} - AvalNobat{% endblock %}

{% block content %}
<div class="form-container" id="financial-report-container">
    {% include 'booking/financial_report_content.html' %}
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('submit', function(e) {
        const container = document.getElementById('financial-report-container');
        if (!container || e.target.name !== 'settle_up') return;

        e.preventDefault();
        const form = e.target.closest('form');
        fetch(form.action, {
            method: 'POST',
            body: new FormData(form),
            headers: { 'X-Requested-With': 'XMLHttpRequest' }
        }).then(() => {
            const currentDate = new Date(localStorage.getItem('userDate'));
            window.updateContentForDate(currentDate, false);
        });
    });
</script>
{% endblock %}
